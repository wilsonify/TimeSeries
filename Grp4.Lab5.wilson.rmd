---
title: "Lab5"
author: "Claudius Taylor, Tom Wilson, Junpu Zhao"
date: "9/26/2018"
output: pdf_document
---

```{R}
library('dplyr')
library('astsa')
library('stringr')
library('data.table')
```

Generate a simple random walk data.


```{R}
w_t <- ts(rnorm(500,0,1))
```


```{R}
plot(w_t)
acf(w_t)
```

Apply ﬁrst-order diﬀerencing.


```{R}
dw_t <- diff(w_t)
```


```{R}
plot(dw_t)
acf(dw_t)
```

Did it remove non-stationarity? *no* it adds non-stationartiy at lag=1.

Apply second-order diﬀerencing.


```{R}
ddw_t <- diff(dw_t)
```

Did it remove non-stationarity? *No* it intoduces non-stationarity at lag=2


```{R}
plot(ddw_t)
acf(ddw_t)
```

Consider the immigration data from BB. 


```{R}
library(data.table)
library(dplyr)
library(stringr)
library(lubridate)
```


```{R}
immigration_data = fread('https://raw.githubusercontent.com/wilsonify/TimeSeries/master/data/immigration.csv')
```


```{R}
plot(immigration_data$yr,immigration_data$count)
acf(immigration_data$count)
```

Stationary? No

If not stationary then try to stationarize the data.



```{R}
dcount <- diff(immigration_data$count)
acf(dcount)
```

Consider the Monthly Australian Beer Consumption data from BB.

Decompose the data and interpret.


```{R}
beer_data = fread('https://raw.githubusercontent.com/wilsonify/TimeSeries/master/data/monthly-beer-production-in-austr.csv')
```

```{R}
colnames(beer_data) <- c('month','beer')
```

```{R}
beer_data$month <- beer_data$month %>% paste("01",sep="") %>% lubridate::as_date()
```

```{R}
trend_beer = ma(timeserie_beer, order = 4, centre = T)
plot(beer)
acf(beer)
```

```{R}
dbeer <- diff(beer)
plot(dbeer)
acf(dbeer)
```

```{R}
ddbeer <- diff(dbeer)
plot(ddbeer)
acf(ddbeer)
```

first and second order differencing is not sufficient to remove non-stationarity in beer data.



```{R}
decompose(beer,"additive")
```